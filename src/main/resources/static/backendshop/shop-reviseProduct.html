<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>ezdom</title>

    <!-- Custom fonts for this template-->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
            href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
            rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="css/sb-admin-2.min.css" rel="stylesheet">
    <!-- App favicon -->
    <link rel="shortcut icon" href="assets/images/favicon.ico">

    <!-- select2 css -->
    <link href="assets/libs/select2/css/select2.min.css" rel="stylesheet" type="text/css" />

    <!-- dropzone css -->
    <link href="assets/libs/dropzone/min/dropzone.min.css" rel="stylesheet" type="text/css" />

    <!-- preloader css -->
    <link rel="stylesheet" href="assets/css/preloader.min.css" type="text/css" />

    <!-- Bootstrap Css -->
    <link href="assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css" />
    <!-- Icons Css -->
    <link href="assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <!-- App Css-->
    <link href="assets/css/app.min.css" id="app-style" rel="stylesheet" type="text/css" />
    <!-- 引入 SweetAlert2 的 CSS 文件 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.min.css">
    <style>
        .upload-container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #ffffff;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.1);
        }

        .upload-label {
            font-size: 16px;
            font-weight: bold;
        }

        #imagePreview {
            max-width: 100%;
            max-height: 200px;
            margin-top: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.1);
        }

        /* 新增的 */
        .product-id {
            font-size: 24px;
            font-weight: bold;
            color: black;
        }
    </style>
</head>

<body id="page-top">

<!-- Page Wrapper -->
<div id="wrapper">

    <!-- Sidebar -->
    <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

        <!-- Sidebar - Brand -->
        <a  class="sidebar-brand d-flex align-items-center justify-content-center" href="/ezdom/dashboard.html">
            <div style="transform: rotate(-5deg)">
                <img width="40px"  src="/ezdom/backendemp/img/FBI.png" >
            </div>
            <div class="sidebar-brand-text mx-3">EZDOM</div>
        </a>

        <!-- Divider -->
        <hr class="sidebar-divider my-0">


        <!-- Nav Item - Dashboard -->
        <li class="nav-item active position1">
            <a class="nav-link" href="/ezdom/backendemp/empAll.html">
                <i class="fas fa-fw fa-tachometer-alt"></i>
                <span>員工管理</span></a>

        </li>

        <!-- Divider -->
        <hr class="sidebar-divider">


        <!-- Heading -->
        <div class="sidebar-heading position2">
            會員管理
        </div>
        <!-- Nav Item - Pages Collapse Menu -->
        <li class="nav-item position2">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseOne"
               aria-expanded="true" aria-controls="collapseOne">
                <i class="fas fa-fw fa-cog"></i>
                <span>會員查詢</span>
            </a>
            <div id="collapseOne" class="collapse" data-parent="#accordionSidebar1">
                <div style="width:90% ;margin-left: 10px;" class="bg-white py-2 collapse-inner rounded">
                    <a class="collapse-item" href="/ezdom/backendmember/member-list.html">會員列表</a>
                </div>
            </div>
        </li>
        <li class="nav-item position2">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
               aria-expanded="true" aria-controls="collapseTwo">
                <i class="fas fa-fw fa-cog"></i>
                <span>教練審核</span>
            </a>
            <div id="collapseTwo" class="collapse" data-parent="#accordionSidebar2">
                <div style="width:90% ;margin-left: 10px;" class="bg-white py-2 collapse-inner rounded">
                    <a class="collapse-item" href="/ezdom/backendcoach/coach-verify.html">教練審核</a>
                </div>
            </div>
        </li>







        <!-- Heading -->
        <div class="sidebar-heading position3">
            商城管理
        </div>

        <!-- Nav Item - Pages Collapse Menu -->
        <li class="nav-item position3">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseFive"
               aria-expanded="true" aria-controls="collapseFive">
                <i class="fas fa-fw fa-chart-area"></i>
                <span>商品管理</span>
            </a>
            <div id="collapseFive" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar5">
                <div style="width:90% ;margin-left: 10px;" class="bg-white py-2 collapse-inner rounded">
                    <a class="collapse-item" href="/ezdom/backendshop/shop-product.html">商品列表</a>
                    <a class="collapse-item" href="/ezdom/backendshop/shop-addProduct.html">商品新增</a>
                </div>
            </div>
        </li>
        <li class="nav-item position3">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseSix"
               aria-expanded="true" aria-controls="collapseSix">
                <i class="fas fa-fw fa-chart-area"></i>
                <span>訂單管理</span>
            </a>
            <div id="collapseSix" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar6">
                <div style="width:90% ;margin-left: 10px;" class="bg-white py-2 collapse-inner rounded">
                    <a class="collapse-item" href="/ezdom/backendshop/shop-orders.html">訂單列表</a>
                    <a class="collapse-item" href="/ezdom/backendshop/shop-return.html">退貨管理</a>
                </div>
            </div>
        </li>
        <li class="nav-item position3">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseEle"
               aria-expanded="true" aria-controls="collapseEle">
                <i class="fas fa-fw fa-chart-area"></i>
                <span>廣告管理</span>
            </a>
            <div id="collapseEle" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar11">
                <div style="width:90% ;margin-left: 10px;" class="bg-white py-2 collapse-inner rounded">
                    <a class="collapse-item" href="/ezdom/backendad/adAll.html">廣告一覽</a>
                    <a class="collapse-item" href="/ezdom/backendad/adAdd.html">廣告新增</a>
                </div>
            </div>
        </li>



        <!-- Heading -->
        <div class="sidebar-heading position3">
            揪團管理
        </div>

        <!-- Nav Item - Pages Collapse Menu -->
        <li class="nav-item position3">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwe"
               aria-expanded="true" aria-controls="collapseTwe">
                <i class="fas fa-fw fa-chart-area"></i>
                <span>揪團審核管理</span>
            </a>
            <div id="collapseTwe" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar12">
                <div style="width:90% ;margin-left: 10px;" class="bg-white py-2 collapse-inner rounded">
                    <a class="collapse-item" href="/ezdom/admingroup/back-admin-group.html">揪團審核清單</a>
                    <a class="collapse-item" href="/ezdom/admingroup/back-admin-groupdetail.html">揪團審核明細</a>
                </div>
            </div>
        </li>
        <li class="nav-item position3">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseSeven"
               aria-expanded="true" aria-controls="collapseSeven">
                <i class="fas fa-fw fa-chart-area"></i>
                <span>揪團檢舉</span>
            </a>
            <div id="collapseSeven" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar7">
                <div style="width:90% ;margin-left: 10px;" class="bg-white py-2 collapse-inner rounded">
                    <a class="collapse-item" href="/ezdom/groupreport/groupreport.html">揪團檢舉列表</a>
                </div>
            </div>
        </li>


        <!-- Heading -->
        <div class="sidebar-heading position2">
            其他功能
        </div>

        <!-- Nav Item - Pages Collapse Menu -->
        <li class="nav-item position2">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseEight"
               aria-expanded="true" aria-controls="collapseEight">
                <i class="fas fa-fw fa-chart-area"></i>
                <span>論壇管理</span>
            </a>
            <div id="collapseEight" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar8">
                <div style="width:90% ;margin-left: 10px;" class="bg-white py-2 collapse-inner rounded">
                    <a class="collapse-item" href="/ezdom/backendforum/forum-backreport.html">論壇管理</a>
                </div>
            </div>
        </li>

        <li class="nav-item position2">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseNine"
               aria-expanded="true" aria-controls="collapseNine">
                <i class="fas fa-fw fa-chart-area"></i>
                <span>QA管理</span>
            </a>
            <div id="collapseNine" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar9">
                <div style="width:90% ;margin-left: 10px;" class="bg-white py-2 collapse-inner rounded">
                    <a class="collapse-item" href="/ezdom/backendsupport/faq.html">QA管理</a>
                    <a class="collapse-item" href="/ezdom/backendsupport/support.html">即時客服</a>
                </div>
            </div>
        </li>

        <li class="nav-item position2">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTen"
               aria-expanded="true" aria-controls="collapseTen">
                <i class="fas fa-fw fa-chart-area"></i>
                <span>最新消息管理</span>
            </a>
            <div id="collapseTen" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar10">
                <div style="width:90% ;margin-left: 10px;" class="bg-white py-2 collapse-inner rounded">
                    <a class="collapse-item" href="/ezdom/latestnews/back-news.html">最新消息管理</a>
                </div>
            </div>
        </li>


    </ul>
    <!-- 上面是左側欄位 -->

    <!-- End of Sidebar -->

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">

        <!-- Main Content -->
        <div id="content">

            <!-- Topbar -->
            <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">

                <!-- Sidebar Toggle (Topbar) -->
                <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                    <i class="fa fa-bars"></i>
                </button>

                <!-- Topbar Navbar -->
                <ul class="navbar-nav ml-auto">


                    <!-- Nav Item - Messages -->


                    <div class="topbar-divider d-none d-sm-block"></div>

                    <!-- Nav Item - User Information 111-->
                    <li class="nav-item dropdown no-arrow">
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="mr-2 d-none d-lg-inline text-gray-600 small" id="empName">員工姓名</span>
                            <img class="img-profile rounded-circle"
                                 src="/ezdom/backendemp/img/cutieebk.png">
                        </a>
                        <!-- Dropdown - User Information -->
                        <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in"
                             aria-labelledby="userDropdown">
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">
                                <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>
                                登出
                            </a>
                        </div>
                    </li>
                </ul>
            </nav>
            <!-- 上方員工姓名欄位 -->
            <!-- End of Topbar -->

            <!-- Begin Page Content -->
            <div class="main-content">

                <div style="padding:0px" class="page-content">
                    <div class="container-fluid">

                        <!-- start page title -->
                        <div class="row">
                            <div class="col-12">
                                <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                                    <h4 class="mb-sm-0 font-size-18">商品編輯</h4>
                                </div>
                            </div>
                        </div>
                        <!-- end page title -->

                        <div class="row">
                            <div style="padding: 0;" class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <span class="card-title product-id">目前修改的商品ID:</span><span
                                            id="reviseId"></span>
                                    </div>
                                    <div class="card-body">
                                        <div id="renew">
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <div class="mb-3">
                                                        <label for="productname">商品名稱</label>
                                                        <input id="productname" name="productname" type="text"
                                                               class="form-control">
                                                    </div>
                                                    <div class="mb-3">
                                                        <label for="originPrice">原始價錢</label>
                                                        <input id="originPrice" name="originPrice" type="text"
                                                               class="form-control">
                                                    </div>
                                                    <div class="mb-3">
                                                        <label for="discountPrice">優惠價錢</label>
                                                        <input id="discountPrice" name="discountPrice"
                                                               type="text" class="form-control">
                                                    </div>

                                                </div>

                                                <div class="col-sm-6">
                                                    <div class="mb-3">
                                                        <label class="control-label">商品類型</label>
                                                        <select id="sportCategory" style="width: 50%"
                                                                class="form-control select2">
                                                            <option>選擇</option>
                                                            <option value="1">球類</option>
                                                            <option value="2">運動服</option>
                                                            <option value="3">運動褲</option>
                                                        </select>
                                                    </div>
                                                    <div class="mb-3">
                                                        <label for="productdesc">商品描述</label>
                                                        <textarea class="form-control" id="productdesc"
                                                                  rows="6"></textarea>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <div class="d-flex flex-wrap gap-2 justify-content-end">
                                            <button id="uditBtn" type="button"class="btn btn-primary waves-effect waves-light">確定修改</button>
                                            <button id="cancelBtn" type="button"class="btn btn-secondary waves-effect waves-light">取消</button>
                                        </div>
                                    </div>
                                </div>

                                <div class="card" style="height: 450px;">
                                    <div class="card-header">
                                        <h4 class="card-title mb-0">商品圖片</h4>
                                    </div>
                                    <div class="card-body">
                                        <div class="upload-container" style="min-height: 100%;">
                                            <label class="upload-label" for="imageUpload">選擇圖片：</label>
                                            <p id="imageUploadError" style="color: red;"></p>
                                            <input type="file" id="imageUpload" accept="image/*">
                                            <div id="imagePreviewContainer">

                                            </div>
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>
                        <!-- end row -->

                    </div> <!-- container-fluid -->
                </div>
                <!-- End of Main Content -->

                <!-- Footer -->
                <footer class="sticky-footer bg-white">
                    <div class="container my-auto">
                        <div class="copyright text-center my-auto">
                            <span>EZDOM &copy; 後台管理系統</span>
                        </div>
                    </div>
                </footer>
                <!-- End of Footer -->

            </div>
            <!-- End of Content Wrapper -->

        </div>
        <!-- End of Page Wrapper -->

        <!-- Scroll to Top Button-->
        <a class="scroll-to-top rounded" href="#page-top">
            <i class="fas fa-angle-up"></i>
        </a>

        <!-- Logout Modal-->
        <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
             aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">是否登出?</h5>
                        <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body">你真的要登出嗎?</div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" type="button" data-dismiss="modal">取消</button>
                        <a class="btn btn-primary" onclick="logout()" style="cursor: pointer;">登出</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Bootstrap core JavaScript-->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- Custom scripts for all pages-->
<script src="js/sb-admin-2.min.js"></script>
<!-- 初始化折疊功能 -->
<script src="js/aside.js"></script>

<!-- JAVASCRIPT -->
<script src="assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/libs/metismenu/metisMenu.min.js"></script>
<script src="assets/libs/simplebar/simplebar.min.js"></script>
<script src="assets/libs/node-waves/waves.min.js"></script>
<script src="assets/libs/feather-icons/feather.min.js"></script>
<!-- pace js -->
<script src="assets/libs/pace-js/pace.min.js"></script>

<!-- select 2 plugin -->
<script src="assets/libs/select2/js/select2.min.js"></script>

<!-- dropzone plugin -->
<script src="assets/libs/dropzone/min/dropzone.min.js"></script>

<!-- init js -->
<script src="assets/js/pages/ecommerce-select2.init.js"></script>

<script src="assets/js/app.js"></script>

<!-- 引入 SweetAlert2 的 JavaScript 文件 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.all.min.js"></script>

<!-- 圖片新增js -->
<script>
    const imageUpload = document.getElementById('imageUpload');
    const imagePreview = document.getElementById('imagePreviewContainer');
    const imageUploadError = document.getElementById('imageUploadError');

    imageUpload.addEventListener('change', function (event) {
        const selectedImage = event.target.files[0];
        if (selectedImage) {
            const reader = new FileReader();
            reader.onload = function (e) {

                const newImage = document.createElement('img');
                newImage.id = 'imagePreview';
                newImage.src = e.target.result;
                newImage.alt = '預覽圖片';
                newImage.style.maxWidth = '100%';
                newImage.style.height = 'auto';

                imagePreviewContainer.innerHTML = '';
                imagePreviewContainer.appendChild(newImage);

            };
            reader.readAsDataURL(selectedImage);
        } else {
            imagePreviewContainer.innerHTML = '';

        }
    });
</script>

<script>
    // 獲取URL中的Query參數
    const urlParams = new URLSearchParams(window.location.search);
    const productId = urlParams.get('productId');
    let reviseId = document.getElementById("reviseId");
    reviseId.innerHTML = `<span class="product-id">${productId}</span>`;
    let renew = document.getElementById("renew");
    //依id抓商品資料回來修改
    window.addEventListener('load', function () {
        fetch(`/ezdom/backend/product/getById/${productId}`)
            .then(resp => resp.json())
            .then(body => {
                let { categoryId, productName, productDescription, productOriginPrice, productDiscountPrice, productImage, category } = body;
                let { typeName } = category;

                let html = `
        <div class="row">
            <div class="col-sm-6">
                <div class="mb-3">
                    <label for="productname">商品名稱</label>
                    <input id="productname" name="productname" type="text"
                        class="form-control" value="${productName}">
                    <p id="productnameError" style="color: red;"></p>
                </div>
                <div class="mb-3">
                    <label for="originPrice">原始價錢</label>
                    <input id="originPrice" name="originPrice" type="text"
                        class="form-control" value="${productOriginPrice}">
                    <p id="originPriceError" style="color: red;"></p>
                </div>
                <div class="mb-3">
                    <label for="discountPrice">優惠價錢</label>
                    <input id="discountPrice" name="discountPrice"
                        type="text" class="form-control" value="${productDiscountPrice}">
                    <p id="discountPriceError" style="color: red;"></p>
                </div>

            </div>

            <div class="col-sm-6">
                <div class="mb-3">
                    <label class="control-label">商品類型</label>
                    <select id="sportCategory" style="width: 50%"
                    class="form-control select2">
                    <option value="${categoryId}">${typeName}</option>
                    <option value="1">健身器材</option>
                    <option value="2">戶外運動用品</option>
                    <option value="3">球類運動用品</option>
                    <option value="4">水上運動用品</option>
                    <option value="5">運動服飾與鞋款</option>
                    <option value="6">運動食品與營養補充品</option>
                </select>
                <p id="sportCategoryError" style="color: red;"></p>
                </div>
                <div class="mb-3">
                    <label for="productdesc">商品描述</label>
                    <textarea class="form-control" id="productdesc" ${productDescription}
                        rows="6">${productDescription}</textarea >
                </div>

            </div>
        </div>
        `;
                renew.innerHTML = html;
            })
    });


    //取消按鈕
    let cancelBtn =document.getElementById("cancelBtn");
    cancelBtn.addEventListener("click",function(){
        Swal.fire({
        icon: 'info',
        title: '返回',
        text: '是否確定返回上一頁?',
        showCancelButton: true,  // 顯示取消按鈕
        confirmButtonText: '確定'
    }).then((result) => {
        if (result.isConfirmed) {
            window.location.replace("shop-product.html");
        }
    })})


    //js抓錯
    function validateProductname(){
    let productnameError = document.getElementById("productnameError");
    if(!productname.value){
        productnameError.textContent = "請勿為空值";
        return false;
    }else {
        productnameError.textContent = "";
        return true;
    }
}

    function validateOriginPrice() {
    let originPriceError = document.getElementById("originPriceError");
    var originPricePattern = /^[0-9]+$/;

    if (!originPricePattern.test(originPrice.value)) {
        originPriceError.textContent = "僅能輸入數字";
        return false;
    } else if (parseInt(originPrice.value) < parseInt(discountPrice.value)) {
        originPriceError.textContent = "不可低於優惠價";
        return false;
    } else {
        originPriceError.textContent = "";
        return true;
    }
    }

function validateDiscountPrice() {
    let discountPriceError = document.getElementById("discountPriceError");
    var discountPricePattern = /^[0-9]+$/;

    if (!discountPricePattern.test(discountPrice.value)) {
        discountPriceError.textContent = "僅能輸入數字";
        return false;
    }  else if (parseInt(discountPrice.value) > parseInt(originPrice.value)) {
        discountPriceError.textContent = "不可高於原始價錢";
        return false;
    } else {
        discountPriceError.textContent = "";
        return true;
    }
    }

function validatesportCategory(){
    let sportCategoryError =document.getElementById("sportCategoryError");

    if(sportCategory.value=="請選擇"){
        sportCategoryError.textContent = "類別不可為空";
        return false;
    }else {
        sportCategoryError.textContent = "";
        return true;
    }
}

function validateImageUpload() {

    if (!imageUpload.value) {
        imageUploadError.textContent = "請選擇圖片";
        return false;
    } else {
        imageUploadError.textContent = "";
        return true;
    }
}

    //確認修改按鈕
    let uditBtn=document.getElementById("uditBtn");
    uditBtn.addEventListener("click",function(){
    let productname = document.getElementById("productname");
    let originPrice = document.getElementById("originPrice");
    let discountPrice = document.getElementById("discountPrice");
    let sportCategory = document.getElementById("sportCategory");
    let productdesc = document.getElementById("productdesc");
    let imageUpload = document.getElementById('imageUpload');

    let fileReader = new FileReader();
    let productNameValid = validateProductname();
    let originPriceValid = validateOriginPrice();
    let discountPriceValid = validateDiscountPrice();
    let sportCategoryValid = validatesportCategory();
    let imageUploadValid = validateImageUpload();

    var isValid = productNameValid && originPriceValid && discountPriceValid && sportCategoryValid && imageUploadValid;

    if (isValid) {
        Swal.fire({
            icon: 'success',
            title: '成功',
            text: '資料已成功提交！',
            confirmButtonText: '確定',
            focusConfirm: true
        }).then((result) => {
            if (result.isConfirmed) {
                // 在確認後進行頁面跳轉
                fileReader.addEventListener("load", function (e) {
                    const imageBase64 = btoa(e.target.result);
                    fetch(`/ezdom/backend/product/edit/${productId}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            categoryId: sportCategory.value,
                            productName: productname.value,
                            productDescription: productdesc.value,
                            productOriginPrice: originPrice.value,
                            productDiscountPrice: discountPrice.value,
                            productImage: imageBase64
                        }),
                    }).then(response => {
                    if (response.status === 401) {
                        // 重定向到登录页面 登入失敗
                        window.location.href = '/ezdom/backendemp/empSignin.html';
                    }else if(response.ok){
                        //登入成功
                        return response.json();
                    }
                }).then(body => {
                            const { successful, message } = body;
                            if (successful) {
                                window.location.replace("shop-product.html");
                            } else {
                                alert(message);
                            }
                        });
                });
                fileReader.readAsBinaryString(imageUpload.files[0]);
            }
        });
    } else {
        Swal.fire({
            icon: 'error',
            title: '資料尚未完善',
            text: '請再次確認有無錯誤',
            confirmButtonText: '確定',
            focusConfirm: true
        });
        }
    });

     //員工登出及姓名
    let empName=document.getElementById("empName");
         function logout(){
             fetch('/ezdom/employee/logout')
             .then(resp=>resp.json())
             .then(body=>{
                 let {successful}=body;
                 if(successful){
                     window.location.href = '/ezdom/backendemp/empSignin.html';
                 }
             })
         }
         function getEmp(){
             fetch('/ezdom/backend/employee/getById')
             .then(response => {
                    if (response.status === 401) {
                        // 重定向到登录页面 登入失敗
                        window.location.href = '/ezdom/backendemp/empSignin.html';
                    }else if(response.ok){
                        //登入成功
                        return response.json();
                    }
                }).then(body=>{
                 let {employeeName}=body;
                 empName.textContent =employeeName;
             })
         }
    function getPosition() {
  fetch('/ezdom/backend/employee/getById')
    .then(response => {
      if (response.status === 401) {
        // 重定向到登录页面 登入失敗
        window.location.href = '/ezdom/backendemp/empSignin.html';
      } else if (response.ok) {
        return response.json();
      }
    })
    .then(body => {
      let { employeePosition } = body;
      console.log(employeePosition);

      // 找到要删除的元素
      const elementsToDelete = document.querySelectorAll('.position1, .position3, .position2');

      // 依 employeePosition 的值 刪除不符職位的連結
      if (employeePosition === 2) {
        // 删除包含 position1 或 position3
        elementsToDelete.forEach(element => {
          if (element.classList.contains('position1') || element.classList.contains('position3')) {
            element.remove();
          }
        });
      } else if (employeePosition === 3) {
        // 删除包含 position1 或 position2
        elementsToDelete.forEach(element => {
          if (element.classList.contains('position1') || element.classList.contains('position2')) {
            element.remove();
          }
        });
      }
    });
}

         getPosition();
         getEmp();
</script>


</body>

</html>